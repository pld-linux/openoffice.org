diff -Nur oo.orig/berkeleydb/makefile.mk oo.chng/berkeleydb/makefile.mk
--- oo.orig/berkeleydb/makefile.mk	Thu Jun 12 11:50:38 2003
+++ oo.chng/berkeleydb/makefile.mk	Wed Jul 30 19:14:32 2003
@@ -65,6 +65,16 @@
 PRJNAME=so_berkeleydb
 TARGET=so_berkeleydb
 
+# --- Hack to get system db libraries ------------------------------
+.IF "$(GUI)"=="UNX"
+all:
+	@echo "Since you're running a real OS, we're assuming you have db..."
+	+$(COPY) /usr$/lib$/libdb-4.2.so $(DLLDEST)
+	+$(COPY) /usr$/lib$/libdb_cxx-4.2.so $(DLLDEST)
+	+$(COPY) /usr$/lib$/libdb_java-4.2.so $(DLLDEST)
+	+$(COPY) /usr$/lib$/db.jar $(DLLDEST)
+.ENDIF
+
 # --- Settings -----------------------------------------------------
 
 .INCLUDE :	settings.mk
diff -Nur oo.orig/berkeleydb/prj/d.lst oo.chng/berkeleydb/prj/d.lst
--- oo.orig/berkeleydb/prj/d.lst	Mon Jul 14 20:43:57 2003
+++ oo.chng/berkeleydb/prj/d.lst	Wed Jul 30 19:13:27 2003
@@ -1,15 +1,17 @@
 mkdir: %_DEST%\inc%_EXT%\berkeleydb
 
-..\%__SRC%\inc\db_cxx.h %_DEST%\inc%_EXT%\berkeleydb\db_cxx.h
-..\%__SRC%\inc\db_185.h %_DEST%\inc%_EXT%\berkeleydb\db_185.h
-..\%__SRC%\inc\db.h %_DEST%\inc%_EXT%\berkeleydb\db.h
+\usr\include\db_cxx.h %_DEST%\inc%_EXT%\berkeleydb\db_cxx.h
+\usr\include\cxx_common.h %_DEST%\inc%_EXT%\berkeleydb\cxx_common.h
+\usr\include\cxx_except.h %_DEST%\inc%_EXT%\berkeleydb\cxx_except.h
+\usr\include\db_185.h %_DEST%\inc%_EXT%\berkeleydb\db_185.h
+\usr\include\db.h %_DEST%\inc%_EXT%\berkeleydb\db.h
 
 ..\%__SRC%\lib\libdb32.lib %_DEST%\lib%_EXT%\libdb32.lib
 ..\%__SRC%\lib\libdb_java32.lib %_DEST%\lib%_EXT%\libdb_java32.lib
 
-..\%__SRC%\lib\libdb-3.2.so %_DEST%\lib%_EXT%\libdb-3.2.so
-..\%__SRC%\lib\libdb_java-3.2.so %_DEST%\lib%_EXT%\libdb_java-3.2.so
-..\%__SRC%\lib\libdb_cxx-3.2.so %_DEST%\lib%_EXT%\libdb_cxx-3.2.so
+\usr\lib\libdb-4.2.so %_DEST%\lib%_EXT%\libdb-4.2.so
+\usr\lib\libdb_java-4.2.so %_DEST%\lib%_EXT%\libdb_java-4.2.so
+\usr\lib\libdb_cxx-4.2.so %_DEST%\lib%_EXT%\libdb_cxx-4.2.so
 
 ..\%__SRC%\lib\libdb-3.2.dylib %_DEST%\lib%_EXT%\libdb-3.2.dylib
 ..\%__SRC%\lib\libdb_java-3.2.dylib %_DEST%\lib%_EXT%\libdb_java-3.2.dylib
@@ -18,5 +20,5 @@
 ..\%__SRC%\bin\libdb32.dll %_DEST%\bin%_EXT%\libdb32.dll
 ..\%__SRC%\bin\libdb_java32.dll %_DEST%\bin%_EXT%\libdb_java32.dll
 
-..\%__SRC%\bin\db.jar %_DEST%\bin%_EXT%\db.jar
+\usr\share\java\db.jar %_DEST%\bin%_EXT%\db.jar
 
diff -Nur oo.orig/config_office/makefile.rc oo.chng/config_office/makefile.rc
--- oo.orig/config_office/makefile.rc	Mon Jul  7 16:46:29 2003
+++ oo.chng/config_office/makefile.rc	Wed Jul 30 19:05:47 2003
@@ -159,7 +159,6 @@
 	so3 \
 	soltools \
 	sot \
-	berkeleydb \
 	starmath \
 	stoc \
 	store \
diff -Nur oo.orig/scp/source/office/files.scp oo.chng/scp/source/office/files.scp
--- oo.orig/scp/source/office/files.scp	Wed Jul 30 15:28:10 2003
+++ oo.chng/scp/source/office/files.scp	Wed Jul 30 19:09:56 2003
@@ -983,7 +983,7 @@
         Styles          = (PACKED);
         Dir             = GID_DIR_PROGRAM;
         #ifdef UNX
-        Name            = STRING(CONCAT2(libdb-3.2,UNXSUFFIX));
+        Name            = STRING(CONCAT2(libdb-4.2,UNXSUFFIX));
         #else
         Name            = "libdb32.dll";
         #endif
@@ -996,7 +996,7 @@
         Styles          = (PACKED);
         Dir             = GID_DIR_PROGRAM;
         #ifdef UNX
-        Name            = STRING(CONCAT2(libdb_java-3.2,UNXSUFFIX));
+        Name            = STRING(CONCAT2(libdb_java-4.2,UNXSUFFIX));
         #else
         Name            = "libdb_java32.dll";
         #endif
@@ -1010,7 +1010,7 @@
         TXT_FILE_BODY;
         Styles          = (PACKED);
         Dir             = GID_DIR_PROGRAM;
-        Name            = STRING(CONCAT2(libdb_cxx-3.2,UNXSUFFIX));
+        Name            = STRING(CONCAT2(libdb_cxx-4.2,UNXSUFFIX));
 End
 
 #endif
diff -Nur oo.orig/setup2/script/linux/1.0.0/webinstdb.inf oo.chng/setup2/script/linux/1.0.0/webinstdb.inf
--- oo.orig/setup2/script/linux/1.0.0/webinstdb.inf	Thu May 24 08:45:47 2001
+++ oo.chng/setup2/script/linux/1.0.0/webinstdb.inf	Wed Jul 30 19:08:11 2003
@@ -6687,7 +6687,7 @@
 End
 
 File gid_File_Lib_Db31
-	Name		 = "libdb-3.1.so";
+	Name		 = "libdb-4.2.so";
 	PackedName	 = "f_0352";
 	Size		 = 458008;
 	Dir			 = gid_Dir_Program;
@@ -6700,7 +6700,7 @@
 End
 
 File gid_File_Lib_Dbjava31
-	Name		 = "libdb_java-3.1.so";
+	Name		 = "libdb_java-4.2.so";
 	PackedName	 = "f_0353";
 	Size		 = 506820;
 	Dir			 = gid_Dir_Program;
diff -Nur oo.orig/setup2/script/linux/1.0.1/webinstdb.inf oo.chng/setup2/script/linux/1.0.1/webinstdb.inf
--- oo.orig/setup2/script/linux/1.0.1/webinstdb.inf	Thu May 17 16:46:41 2001
+++ oo.chng/setup2/script/linux/1.0.1/webinstdb.inf	Wed Jul 30 19:08:31 2003
@@ -7474,7 +7474,7 @@
 End
 
 File gid_File_Lib_Db31
-	Name		 = "libdb-3.1.so";
+	Name		 = "libdb-4.2.so";
 	PackedName	 = "f_0358";
 	Size		 = 458008;
 	DownloadSize = 196814;
@@ -7488,7 +7488,7 @@
 End
 
 File gid_File_Lib_Dbjava31
-	Name		 = "libdb_java-3.1.so";
+	Name		 = "libdb_java-4.2.so";
 	PackedName	 = "f_0359";
 	Size		 = 506820;
 	DownloadSize = 212931;
diff -Nur oo.orig/setup2/script/linux/1.1.1/webinstdb.inf oo.chng/setup2/script/linux/1.1.1/webinstdb.inf
--- oo.orig/setup2/script/linux/1.1.1/webinstdb.inf	Wed Sep 19 14:58:58 2001
+++ oo.chng/setup2/script/linux/1.1.1/webinstdb.inf	Wed Jul 30 19:08:50 2003
@@ -7512,7 +7512,7 @@
 End
 
 File gid_File_Lib_Db31
-	Name		 = "libdb-3.1.so";
+	Name		 = "libdb-4.2.so";
 	PackedName	 = "f_0361";
 	Size		 = 458008;
 	DownloadSize = 196814;
@@ -7526,7 +7526,7 @@
 End
 
 File gid_File_Lib_Dbjava31
-	Name		 = "libdb_java-3.1.so";
+	Name		 = "libdb_java-4.2.so";
 	PackedName	 = "f_0362";
 	Size		 = 506820;
 	DownloadSize = 212931;
diff -Nur oo.orig/solenv/inc/libs.mk oo.chng/solenv/inc/libs.mk
--- oo.orig/solenv/inc/libs.mk	Wed Jul 30 15:28:09 2003
+++ oo.chng/solenv/inc/libs.mk	Wed Jul 30 19:11:20 2003
@@ -176,8 +176,8 @@
 ZLIB3RDLIB=-lzlib
 JPEG3RDLIB=-ljpeglib
 NEON3RDLIB=-lneon
-BERKELEYLIB=-ldb-3.2
-BERKELEYCPPLIB=-ldb_cxx-3.2
+BERKELEYLIB=-ldb-4.2
+BERKELEYCPPLIB=-ldb_cxx-4.2
 CURLLIB=-lcurl
 SFX2LIB=-lsfx$(OFFICEUPD)$(DLLPOSTFIX)
 SFXLIB=-lsfx$(OFFICEUPD)$(DLLPOSTFIX)
diff -Nur oo.orig/xmlhelp/source/com/sun/star/help/CreateDb.java oo.chng/xmlhelp/source/com/sun/star/help/CreateDb.java
--- oo.orig/xmlhelp/source/com/sun/star/help/CreateDb.java	Mon Nov 20 13:08:42 2000
+++ oo.chng/xmlhelp/source/com/sun/star/help/CreateDb.java	Wed Jul 30 19:16:26 2003
@@ -37,7 +37,7 @@
 		table.set_errpfx( "HelpAccess" );
 		try
 		{
-			table.open( dbName,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
+			table.open( null,dbName,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
 			Dbc cursor = table.cursor( null,0 );
 
 			StringDbt key = new StringDbt();
@@ -131,7 +131,7 @@
       		Db table = new Db(null, 0);
       		table.set_error_stream(System.err);
       		table.set_errpfx("AccessExample");
-      		table.open("e:/rvp603b/help/helpaccess.db", null, Db.DB_HASH, Db.DB_CREATE, 0644);
+      		table.open(null,"e:/rvp603b/help/helpaccess.db", null, Db.DB_HASH, Db.DB_CREATE, 0644);
       		StringDbt key = new StringDbt(key1);
       		StringDbt data = new StringDbt(data1);
       		try
diff -Nur oo.orig/xmlhelp/source/com/sun/star/help/HelpDatabases.java oo.chng/xmlhelp/source/com/sun/star/help/HelpDatabases.java
--- oo.orig/xmlhelp/source/com/sun/star/help/HelpDatabases.java	Thu Mar 27 19:07:28 2003
+++ oo.chng/xmlhelp/source/com/sun/star/help/HelpDatabases.java	Wed Jul 30 19:18:28 2003
@@ -239,7 +239,7 @@
 				table = new Db( null,0 );
 
 				String tablePath = _installDirectory + key + ".db";
-				table.open( tablePath,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
+				table.open( null,tablePath,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
 				_dbHash.put( key,table );
             }
             catch( DbException e )
@@ -274,7 +274,7 @@
 				table = new Db( null,0 );
 
 				String tablePath = _installDirectory + key + ".ht";
-				table.open( tablePath,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
+				table.open( null,tablePath,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
 				_dbHash.put( key,table );
             }
             catch( DbException e )
@@ -517,7 +517,7 @@
 				String fileName = HelpDatabases.getInstallDirectory() + keyStr + ".key";
         		Db table = new Db( null,0 );
 				System.err.println( fileName );
-				table.open( fileName,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
+				table.open( null,fileName,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
 				Dbc cursor = table.cursor( null,0 );
 				StringDbt key = new StringDbt();
 				StringDbt data = new StringDbt();
diff -Nur oo.orig/xmlhelp/source/com/sun/star/help/HelpIndexer.java oo.chng/xmlhelp/source/com/sun/star/help/HelpIndexer.java
--- oo.orig/xmlhelp/source/com/sun/star/help/HelpIndexer.java	Thu Mar 27 19:07:28 2003
+++ oo.chng/xmlhelp/source/com/sun/star/help/HelpIndexer.java	Wed Jul 30 19:18:47 2003
@@ -150,7 +150,7 @@
                     		+ _module
                        		+ ".db";
 
-			table.open( fileName,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
+			table.open( null,fileName,null,Db.DB_BTREE,Db.DB_RDONLY,0644 );
 			Dbc cursor = table.cursor( null,0 );
 			StringDbt key = new StringDbt();
 			StringDbt data = new StringDbt();
@@ -440,7 +440,7 @@
                     		      + _module
                        		      + ".key";
 
-				table.open( fileName,null,Db.DB_BTREE,Db.DB_CREATE,0644 );
+				table.open( null,fileName,null,Db.DB_BTREE,Db.DB_CREATE,0644 );
 
             	for( int i = 0; i < list.length; ++i )
             	{
@@ -481,7 +481,7 @@
                     		+ _module
                        		+ ".ht";
 
-			table.open( fileName,null,Db.DB_BTREE,Db.DB_CREATE,0644 );
+			table.open( null,fileName,null,Db.DB_BTREE,Db.DB_CREATE,0644 );
 
             for( int i = 0; i < list.length; ++i )
             {
diff -Nur oo.orig/xmlhelp/source/cxxhelp/provider/databases.cxx oo.chng/xmlhelp/source/cxxhelp/provider/databases.cxx
--- oo.orig/xmlhelp/source/cxxhelp/provider/databases.cxx	Fri Apr  4 19:09:36 2003
+++ oo.chng/xmlhelp/source/cxxhelp/provider/databases.cxx	Wed Jul 30 19:23:11 2003
@@ -60,7 +60,7 @@
  ************************************************************************/
 
 
-#include <berkeleydb/db_cxx.h>
+#include <db_cxx.h>
 #ifndef _VOS_DIAGNOSE_HXX_
 #include <vos/diagnose.hxx>
 #endif
@@ -497,7 +497,11 @@
 		
 		rtl::OString fileName( fileNameOU.getStr(),fileNameOU.getLength(),osl_getThreadTextEncoding() );
 		
+#if ((DB_VERSION_MAJOR * 10 + DB_VERSION_MINOR) >= 41)
+		if( table->open( NULL, fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#else
 		if( table->open( fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#endif		
 		{
 			table->close( 0 );
 			delete table;
@@ -711,7 +715,12 @@
                                osl_getThreadTextEncoding() );
 		
 		Db table(0,DB_CXX_NO_EXCEPTIONS);
+
+#if ((DB_VERSION_MAJOR * 10 + DB_VERSION_MINOR) >= 41)
+		if( 0 == table.open( NULL,fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#else
 		if( 0 == table.open( fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#endif		
 		{   
 			std::vector<KeywordInfo::KeywordElement> aVector;
 			Db* idmap = getBerkeley( Database,Language );
diff -Nur oo.orig/xmlhelp/source/cxxhelp/provider/urlparameter.cxx oo.chng/xmlhelp/source/cxxhelp/provider/urlparameter.cxx
--- oo.orig/xmlhelp/source/cxxhelp/provider/urlparameter.cxx	Fri Jun 27 11:09:21 2003
+++ oo.chng/xmlhelp/source/cxxhelp/provider/urlparameter.cxx	Wed Jul 30 19:07:08 2003
@@ -94,7 +94,7 @@
 #include <sablot/shandler.h>
 #endif
 #ifndef _DB_CXX_H_
-#include <berkeleydb/db_cxx.h>
+#include <db_cxx.h>
 #endif
 #ifndef _URLPARAMETER_HXX_
 #include <provider/urlparameter.hxx>
