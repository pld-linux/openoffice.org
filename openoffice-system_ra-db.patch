diff -Nur oo/berkeleydb/makefile.mk oo.new/berkeleydb/makefile.mk
--- oo/berkeleydb/makefile.mk	Fri Feb  8 16:18:17 2002
+++ oo.new/berkeleydb/makefile.mk	Sun Apr 14 23:56:12 2002
@@ -117,12 +117,12 @@
 
 .INCLUDE : set_ext.mk
 .INCLUDE :	target.mk
-.INCLUDE :	tg_ext.mk
+#.INCLUDE :	tg_ext.mk
 
-TG_DELIVER : $(INPATH)$/misc$/build$/so_predeliver
-		$(DELIVER)
+#TG_DELIVER : $(INPATH)$/misc$/build$/so_predeliver
+#		$(DELIVER)
 
-.IF "$(BUILD_SOSL)"!=""
-ALLTAR : TG_DELIVER
-.ENDIF			# "$(BUILD_SOSL)"!=""
+#.IF "$(BUILD_SOSL)"!=""
+#ALLTAR : TG_DELIVER
+#.ENDIF			# "$(BUILD_SOSL)"!=""
 
diff -Nur oo/config_office/makefile.rc oo.new/config_office/makefile.rc
--- oo/config_office/makefile.rc	Fri Oct 19 17:25:23 2001
+++ oo.new/config_office/makefile.rc	Sun Apr 14 23:56:12 2002
@@ -155,7 +155,6 @@
 	so3 \
 	soltools \
 	sot \
-	berkeleydb \
 	starmath \
 	stoc \
 	store \
diff -Nur oo/xmlhelp/source/cxxhelp/provider/databases.cxx oo.new/xmlhelp/source/cxxhelp/provider/databases.cxx
--- oo/xmlhelp/source/cxxhelp/provider/databases.cxx	Fri Nov 23 17:51:01 2001
+++ oo.new/xmlhelp/source/cxxhelp/provider/databases.cxx	Mon Apr 15 10:59:50 2002
@@ -60,7 +60,7 @@
  ************************************************************************/
 
 
-#include <berkeleydb/db_cxx.h>
+#include <db_cxx.h>
 #ifndef _VOS_DIAGNOSE_HXX_
 #include <vos/diagnose.hxx>
 #endif
diff -Nur oo/xmlhelp/source/cxxhelp/provider/urlparameter.cxx oo.new/xmlhelp/source/cxxhelp/provider/urlparameter.cxx
--- oo/xmlhelp/source/cxxhelp/provider/urlparameter.cxx	Wed Oct 31 14:08:14 2001
+++ oo.new/xmlhelp/source/cxxhelp/provider/urlparameter.cxx	Mon Apr 15 11:05:50 2002
@@ -88,7 +88,7 @@
 #include <sablot/shandler.h>
 #endif
 #ifndef _DB_CXX_H_
-#include <berkeleydb/db_cxx.h>
+#include <db_cxx.h>
 #endif
 #ifndef _URLPARAMETER_HXX_
 #include <provider/urlparameter.hxx>
--- oo_1.0_src/scp/source/office/files.scp.systemdb	Fri May 31 17:43:01 2002
+++ oo_1.0_src/scp/source/office/files.scp	Fri May 31 17:43:37 2002
@@ -994,7 +994,7 @@
         Styles          = (PACKED);
         Dir             = GID_DIR_PROGRAM;
         #ifdef UNX
-        Name            = "libdb-3.2.so";
+        Name            = "libdb-3.1.so";
         #else
         Name            = "libdb32.dll";
         #endif
@@ -1007,7 +1007,7 @@
         Styles          = (PACKED);
         Dir             = GID_DIR_PROGRAM;
         #ifdef UNX
-        Name            = "libdb_java-3.2.so";
+        Name            = "libdb_java-3.1.so";
         #else
         Name            = "libdb_java32.dll";
         #endif
@@ -1021,7 +1021,7 @@
         BIN_FILE_BODY;
         Styles          = (PACKED);
         Dir             = GID_DIR_PROGRAM;
-        Name            = "libdb_cxx-3.2.so";
+        Name            = "libdb_cxx-3.1.so";
 End
 
 #endif
--- oo_1.0_src/solenv/inc/libs.mk.systemdb	Fri May 31 17:43:57 2002
+++ oo_1.0_src/solenv/inc/libs.mk	Fri May 31 17:45:32 2002
@@ -174,8 +174,8 @@
 ZLIB3RDLIB=-lzlib
 JPEG3RDLIB=-ljpeglib
 NEON3RDLIB=-lneon
-BERKELEYLIB=-ldb-3.2
-BERKELEYCPPLIB=-ldb_cxx-3.2
+BERKELEYLIB=-ldb-3.1
+BERKELEYCPPLIB=-ldb_cxx-3.1
 CURLLIB=-lcurl
 SFX2LIB=-lsfx$(OFFICEUPD)$(DLLPOSTFIX)
 SFXLIB=-lsfx$(OFFICEUPD)$(DLLPOSTFIX)
--- oo_1.0_src/berkeleydb/prj/d.lst.systemdb	Fri May 31 17:38:58 2002
+++ oo_1.0_src/berkeleydb/prj/d.lst	Fri May 31 17:42:14 2002
@@ -1,18 +1,17 @@
 mkdir: %_DEST%\inc%_EXT%\berkeleydb
 
-..\%__SRC%\inc\db_cxx.h %_DEST%\inc%_EXT%\berkeleydb\db_cxx.h
-..\%__SRC%\inc\db_185.h %_DEST%\inc%_EXT%\berkeleydb\db_185.h
-..\%__SRC%\inc\db.h %_DEST%\inc%_EXT%\berkeleydb\db.h
+\usr\include\db3\db_cxx.h %_DEST%\inc%_EXT%\berkeleydb\db_cxx.h
+\usr\include\db3\db_185.h %_DEST%\inc%_EXT%\berkeleydb\db_185.h
+\usr\include\db3\db.h %_DEST%\inc%_EXT%\berkeleydb\db.h
 
 ..\%__SRC%\lib\libdb32.lib %_DEST%\lib%_EXT%\libdb32.lib
 ..\%__SRC%\lib\libdb_java32.lib %_DEST%\lib%_EXT%\libdb_java32.lib
 
-..\%__SRC%\lib\libdb-3.2.so %_DEST%\lib%_EXT%\libdb-3.2.so
-..\%__SRC%\lib\libdb_java-3.2.so %_DEST%\lib%_EXT%\libdb_java-3.2.so
-..\%__SRC%\lib\libdb_cxx-3.2.so %_DEST%\lib%_EXT%\libdb_cxx-3.2.so
+\usr\lib\libdb-3.1.so %_DEST%\lib%_EXT%\libdb-3.1.so
+\usr\lib\libdb_java-3.1.so %_DEST%\lib%_EXT%\libdb_java-3.1.so
+\usr\lib\libdb_cxx-3.1.so %_DEST%\lib%_EXT%\libdb_cxx-3.1.so
 
 ..\%__SRC%\bin\libdb32.dll %_DEST%\bin%_EXT%\libdb32.dll
 ..\%__SRC%\bin\libdb_java32.dll %_DEST%\bin%_EXT%\libdb_java32.dll
 
-..\%__SRC%\bin\db.jar %_DEST%\bin%_EXT%\db.jar
 
--- oo_1.0_src/berkeleydb/makefile.mk.systemdb	Fri May 31 17:34:42 2002
+++ oo_1.0_src/berkeleydb/makefile.mk	Fri May 31 17:38:51 2002
@@ -65,6 +65,16 @@
 PRJNAME=so_berkeleydb
 TARGET=so_berkeleydb
 
+# --- Hack to get system db libraries ------------------------------
+.IF "$(GUI)"=="UNX"
+all:
+	@echo "Since you're running a real OS, we're assuming you have db..."
+	+$(COPY) /usr$/lib$/libdb-3.1.so $(DLLDEST)
+	+$(COPY) /usr$/lib$/libdb_cxx-3.1.so $(DLLDEST)
+	+$(COPY) /usr$/lib$/libdb_java-3.1.so $(DLLDEST)
+	+$(COPY) /usr$/lib$/db.jar $(DLLDEST)
+.ENDIF
+
 # --- Settings -----------------------------------------------------
 
 .INCLUDE :	settings.mk
diff -uNr xmlhelp.old/source/cxxhelp/provider/databases.cxx xmlhelp/source/cxxhelp/provider/databases.cxx
--- oo/xmlhelp.old/source/cxxhelp/provider/databases.cxx	Wed Dec  4 15:19:26 2002
+++ oo/xmlhelp/source/cxxhelp/provider/databases.cxx	Wed Dec  4 15:33:41 2002
@@ -495,7 +495,11 @@
 		
 		rtl::OString fileName( fileNameOU.getStr(),fileNameOU.getLength(),osl_getThreadTextEncoding() );
 		
-		if( table->open( fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#if ((DB_VERSION_MAJOR * 10 + DB_VERSION_MINOR) >= 41)
+     		if( table->open( NULL, fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#else
+     		if( table->open( fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#endif
 		{
 			table->close( 0 );
 			delete table;
@@ -709,7 +713,11 @@
                                osl_getThreadTextEncoding() );
 		
 		Db table(0,DB_CXX_NO_EXCEPTIONS);
+#if ((DB_VERSION_MAJOR * 10 + DB_VERSION_MINOR) >= 41)
+		if( 0 == table.open( NULL, fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#else
 		if( 0 == table.open( fileName.getStr(),0,DB_BTREE,DB_RDONLY,0644 ) )
+#endif
 		{   
 			std::vector<KeywordInfo::KeywordElement> aVector;
 			Db* idmap = getBerkeley( Database,Language );
